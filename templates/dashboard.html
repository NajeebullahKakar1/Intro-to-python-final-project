{% extends "base.html" %}
{% block title %}Dashboard{% endblock %}
{% block content %}
<div class="card">
  <h2>Books</h2>
  <form method="GET" action="{{ url_for('book.dashboard') }}" class="search">
    <input name="q" placeholder="Search by title, author, year, language" value="{{ q }}">
    <button type="submit">Search</button>
  </form>

  {% if admin %}
  <div class="admin-add">
    <h3>Add book (admin)</h3>
    <form method="POST" action="{{ url_for('book.add_book_route') }}">
      <input name="title" placeholder="Title" required>
      <input name="author" placeholder="Author" required>
      <input name="year" placeholder="Year" required>
      <input name="language" placeholder="Language" required>
      <button type="submit">Add Book</button>
    </form>
  </div>
  {% endif %}

  <table>
    <tr><th>Title</th><th>Author</th><th>Year</th><th>Lang</th><th>Status</th><th>Action</th></tr>
    {% for b in books %}
    <tr>
      <td>{{ b.title }}</td>
      <td>{{ b.author }}</td>
      <td>{{ b.year }}</td>
      <td>{{ b.language }}</td>
      <td>{{ "Available" if b.available else "Borrowed" }}</td>
      <td>
        {% if b.available %}
          <a class="btn" href="{{ url_for('borrow.borrow', book_id=b.id) }}">Borrow</a>
        {% else %}
          <a class="btn return" href="{{ url_for('borrow.return_book_route', book_id=b.id) }}">Return</a>
        {% endif %}
        {% if admin %}
          <a class="btn small" href="{{ url_for('book.edit_book', book_id=b.id) }}">Edit</a>
          <a class="btn small danger" href="{{ url_for('book.delete_book_route', book_id=b.id) }}">Delete</a>
        {% endif %}
      </td>
    </tr>
    {% endfor %}
  </table>
</div>
{% endblock %}
